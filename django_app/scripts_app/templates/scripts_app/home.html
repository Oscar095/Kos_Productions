{% extends 'scripts_app/base.html' %}
{% load static %}
{% block title %}Panel de Control{% endblock %}
{% block header_title %}Bienvenido{% endblock %}

<!-- Favicon -->
  <link rel="icon" type="image/png" href="{% static 'assets/img/favicon.png' %}">

  {% block content %}
<p>Selecciona un comando para ejecutar:</p>

<div class="card">
  <div class="card-body">
    <ul class="list-group">
      {% for script in scripts %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>{{ script.name }}</strong><br>
            <small>{{ script.description }}</small>
          </div>
          <form method="get" action="{% url 'run_script' script.id %}" class="mb-0" onsubmit="return handleExecution(this);">
                <button type="submit" class="btn btn-success">
                    Ejecutar
                </button>
            </form>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">No hay scripts disponibles.</li>
      {% endfor %}

<script>
function handleExecution(form) {
    const button = form.querySelector('button');
    button.disabled = true;
    button.innerHTML = `
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        Ejecutando...
    `;
    return true;
}
</script>

    </ul>
  </div>
</div>
{% endblock %}

